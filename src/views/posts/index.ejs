<%- include('../layouts/start.ejs',{title:"Post"}) %>

<div class="card w-full p-6 bg-base-100 shadow-xl mt-2">
  <div class="text-xl font-semibold inline-block">
    Listado de Post
    <div class="inline-block float-right">
      <div class="inline-block float-right">
        <a href="/posts/create" class="btn px-6 btn-sm normal-case btn-primary">
          Crear Nuevo
        </a>
      </div>
    </div>
  </div>
  <div class="divider mt-2"></div>
  <div class="h-full w-full pb-6 bg-base-100">
    <div class="overflow-x-auto w-full">
      <table class="table w-full">
        <thead>
          <tr>
            <th>Nombre</th>
            <th>Reddit User</th>
            <th>Redit Password</th>
            <th>Status</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <% posts.forEach(function(post) { %>
          <tr>
            <td>
              <div class="flex items-center space-x-3">
                <div class="avatar">11
                  <div class="mask mask-squircle w-12 h-12"><img src="https://reqres.in/img/faces/7-image.jpg" alt="Avatar"></div>
                </div>
                <div>
                  <div class="font-bold">Michael</div>
                  <div class="text-sm opacity-50">Lawson</div>
                </div>
              </div>
            </td>

            <td><%= post.nombre %></td>
            <td><%= post.reddit_name %></td>
            <td><%= post.reddit_password %></td>
            <td>
              <%- post.status == 1 ? '<div class="badge badge-primary">Activo</div>':'<div class="badge badge">Desactivado</div>' %>
            </td>
            <td>
              <a href="/usuarios/<%= post.id %>" class="btn btn-square btn-ghost">
                <i class="fa fa-edit"></i>
              </a>
              <button onclick="remove(<%= post.id %>)" class="btn btn-square btn-ghost">
                <i class="fa fa-trash"></i>
              </button>

              <a href="/usuarios/status/<%= post.id %>" class="btn btn-square btn-ghost">
                <%- post.status == 1 ? '<i class="fa fa-circle"></i>':'<i class="fa fa-circle-check"></i>' %>
              </a>
            </td>
          </tr>
          <% }); %>
        </tbody>
      </table>
    </div>
  </div>
</div>
<script>
  async function remove(id) {
    st = confirm('Seguro de eliminar este registro?');
    if (st) {
      console.log(id)
      await fetch(`/usuarios/${id}`, {
        method: 'DELETE'
      });
      location.reload()
    }
  }
</script>
<%- include('../layouts/end.ejs') %>